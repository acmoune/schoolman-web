{"ast":null,"code":"import _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation updateProfile($accountId: ID!, $profileId: ID!, $data: ProfileDataInput!) {\\n    updateProfile(accountId: $accountId, profileId: $profileId, data: $data) {\\n      id birthDate birthPlace residence phoneNumber nationality\\n      nicNumber nicDateOfIssue nicPlaceOfIssue\\n      highestAcademicQualification yearOfIssue englishGradeInGCEOL mathematicsGradeInGCEOL\\n      professionalQualification employmentStatus jobTitle yearsOfExperience employerName employerAddress\\n      otherDetails\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport MainLayout from '../layouts/MainLayout';\nimport ProfileForm from '../components/ProfileForm';\nimport { useAuth } from '../components/AuthContext';\nimport Container from '../components/Container';\nimport { Typography, Button } from '@material-ui/core';\nimport { useMutation } from '@apollo/react-hooks';\nimport { gql } from 'apollo-boost';\nimport Router from 'next/router';\nimport Alert from '../components/Alert';\nimport withApollo from '../lib/with-apollo';\nimport withAuth from '../lib/with-auth';\nvar UPDATE_PROFILE_MUTATION = gql(_templateObject());\n\nfunction EditProfile() {\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser;\n\n  var _useMutation = useMutation(UPDATE_PROFILE_MUTATION),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updateProfile = _useMutation2[0],\n      _ = _useMutation2[1];\n\n  var _useState = useState({\n    open: false,\n    level: 'info',\n    message: ''\n  }),\n      alertOptions = _useState[0],\n      setAlertOptions = _useState[1];\n\n  return __jsx(MainLayout, {\n    title: \"Edit Profile\"\n  }, currentUser && __jsx(\"div\", null, __jsx(Container, null, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      marginTop: 15,\n      marginBottom: 15,\n      paddingBottom: 10,\n      borderBottom: '1px solid #DFDFDF'\n    }\n  }, __jsx(Typography, {\n    variant: \"h6\",\n    color: \"textSecondary\",\n    style: {\n      flexGrow: 1\n    }\n  }, \"Edit Profile\"), __jsx(Button, {\n    variant: \"contained\",\n    color: \"secondary\",\n    size: \"small\",\n    style: {\n      fontWeight: 'bold'\n    },\n    onClick: function onClick() {\n      return Router.push('/myProfile');\n    }\n  }, \"Cancel\"))), __jsx(Container, {\n    maxWidth: 600\n  }, __jsx(\"div\", {\n    style: {\n      marginTop: 15\n    }\n  }, __jsx(ProfileForm, {\n    profile: currentUser.profile,\n    onSubmit: function onSubmit(data) {\n      updateProfile({\n        variables: {\n          accountId: currentUser.id,\n          profileId: currentUser.profile.id,\n          data: data\n        }\n      }).then(function () {\n        return Router.push('/myProfile');\n      })[\"catch\"](function (err) {\n        return setAlertOptions({\n          open: true,\n          level: 'error',\n          message: err.message\n        });\n      });\n    }\n  }), __jsx(Alert, {\n    level: alertOptions.level,\n    message: alertOptions.message,\n    open: alertOptions.open,\n    onClose: function onClose() {\n      return setAlertOptions({\n        open: false,\n        level: alertOptions.level,\n        message: alertOptions.message\n      });\n    }\n  })))));\n}\n\nEditProfile.getInitialProps = function () {\n  return {\n    authRequired: true\n  };\n};\n\nexport default withApollo(withAuth(EditProfile));","map":{"version":3,"sources":["/data/apps/school-manager-client/pages/editProfile.tsx"],"names":["React","useState","MainLayout","ProfileForm","useAuth","Container","Typography","Button","useMutation","gql","Router","Alert","withApollo","withAuth","UPDATE_PROFILE_MUTATION","EditProfile","currentUser","updateProfile","_","open","level","message","alertOptions","setAlertOptions","display","marginTop","marginBottom","paddingBottom","borderBottom","flexGrow","fontWeight","push","profile","data","variables","accountId","id","profileId","then","err","getInitialProps","authRequired"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport MainLayout from '../layouts/MainLayout'\nimport ProfileForm from '../components/ProfileForm'\nimport { useAuth } from '../components/AuthContext'\nimport Container from '../components/Container'\nimport { Typography, Button } from '@material-ui/core'\nimport { useMutation } from '@apollo/react-hooks'\nimport { gql } from 'apollo-boost'\nimport Router from 'next/router'\nimport Alert, { AlertOptions } from '../components/Alert'\nimport withApollo from '../lib/with-apollo'\nimport withAuth from '../lib/with-auth'\n\nconst UPDATE_PROFILE_MUTATION = gql`\n  mutation updateProfile($accountId: ID!, $profileId: ID!, $data: ProfileDataInput!) {\n    updateProfile(accountId: $accountId, profileId: $profileId, data: $data) {\n      id birthDate birthPlace residence phoneNumber nationality\n      nicNumber nicDateOfIssue nicPlaceOfIssue\n      highestAcademicQualification yearOfIssue englishGradeInGCEOL mathematicsGradeInGCEOL\n      professionalQualification employmentStatus jobTitle yearsOfExperience employerName employerAddress\n      otherDetails\n    }\n  }\n`\n\nfunction EditProfile() {\n  const { currentUser } = useAuth()\n  const [updateProfile, _] = useMutation(UPDATE_PROFILE_MUTATION)\n  const [alertOptions, setAlertOptions] = useState<AlertOptions>({ open: false, level: 'info', message: '' })\n\n  \n  return (\n    <MainLayout title=\"Edit Profile\">\n      {currentUser &&\n        <div>\n          <Container>\n            <div style={{ display: 'flex',marginTop: 15, marginBottom: 15, paddingBottom: 10, borderBottom: '1px solid #DFDFDF' }}>\n              <Typography variant=\"h6\" color=\"textSecondary\" style={{ flexGrow: 1 }}>Edit Profile</Typography>\n\n              <Button \n                variant=\"contained\" \n                color=\"secondary\" \n                size=\"small\" \n                style={{ fontWeight: 'bold' }}\n                onClick={() => Router.push('/myProfile')}\n              >\n                Cancel\n              </Button>\n            </div>\n          </Container>\n\n          <Container maxWidth={600}>\n            <div style={{ marginTop: 15 }}>\n              <ProfileForm \n                profile={currentUser.profile}\n                onSubmit={(data) => {\n                  updateProfile({\n                    variables: { \n                      accountId: currentUser.id, \n                      profileId: currentUser.profile.id,\n                      data\n                    }\n                  })\n                    .then(() => Router.push('/myProfile'))\n                    .catch(err => setAlertOptions({ open: true, level: 'error', message: err.message }))\n                }}\n              />\n\n              <Alert \n                level={alertOptions.level}\n                message={alertOptions.message}\n                open={alertOptions.open}\n                onClose={() => setAlertOptions({ open: false, level: alertOptions.level, message: alertOptions.message })}\n              />\n            </div>\n          </Container>\n        </div>\n      }\n    </MainLayout>\n  )\n}\n\nEditProfile.getInitialProps = () => ({ authRequired: true })\n\nexport default withApollo(withAuth(EditProfile))\n"]},"metadata":{},"sourceType":"module"}