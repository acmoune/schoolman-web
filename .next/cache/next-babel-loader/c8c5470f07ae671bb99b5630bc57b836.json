{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  query getApplier {\\n    applier @client {\\n      name\\n      email\\n    }\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query getApplicationProfile {\\n    applicationProfile @client {\\n      birthDate\\n      birthPlace\\n      residence\\n      phoneNumber\\n      nationality\\n      nicNumber\\n      nicDateOfIssue\\n      nicPlaceOfIssue\\n      highestAcademicQualification\\n      yearOfIssue\\n      englishGradeInGCEOL\\n      mathematicsGradeInGCEOL\\n      professionalQualification\\n      employmentStatus\\n      jobTitle\\n      yearsOfExperience\\n      employerName\\n      employerAddress\\n      otherDetails\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport { Stepper, Step, StepLabel, Button, Paper, Hidden, Typography, Table, TableHead, TableBody, TableRow, TableCell, CircularProgress } from '@material-ui/core';\nimport Container from './Container';\nimport { useAuth } from '../components/AuthContext';\nimport ProfileForm from '../components/ProfileForm';\nimport ProfileView from './ProfileView';\nimport Link from 'next/link';\nimport { gql } from 'apollo-boost';\nimport { useApolloClient } from '@apollo/react-hooks';\nimport ApplierForm from './ApplierForm';\nimport Alert from '../components/Alert';\nimport sendMail from '../lib/send-mail';\nimport { applicationReceiver } from '../app.config';\nvar GET_APPLICATION_PROFILE_QUERY = gql(_templateObject());\nvar GET_APPLIER_QUERY = gql(_templateObject2());\n\nvar resetApplicationData = function resetApplicationData(client) {\n  client.writeQuery({\n    query: GET_APPLIER_QUERY,\n    data: {\n      applier: {\n        __typename: 'Applier',\n        name: '',\n        email: ''\n      }\n    }\n  });\n  client.writeQuery({\n    query: GET_APPLICATION_PROFILE_QUERY,\n    data: {\n      applicationProfile: {\n        __typename: 'ProfileData',\n        birthDate: null,\n        birthPlace: '',\n        residence: '',\n        phoneNumber: '',\n        nationality: '',\n        nicNumber: '',\n        nicDateOfIssue: null,\n        nicPlaceOfIssue: '',\n        highestAcademicQualification: '',\n        yearOfIssue: new Date().getFullYear(),\n        englishGradeInGCEOL: '',\n        mathematicsGradeInGCEOL: '',\n        professionalQualification: '',\n        employmentStatus: 'JobSeeker',\n        jobTitle: '',\n        yearsOfExperience: 0,\n        employerName: '',\n        employerAddress: '',\n        otherDetails: null\n      }\n    }\n  });\n};\n\nexport default function ApplicationStepper(props) {\n  var classes = makeStyles(function (theme) {\n    return createStyles({\n      root: {\n        width: '100%'\n      },\n      btnBar: {\n        display: 'flex',\n        padding: '10px 0px',\n        borderTop: '1px solid #DFDFDF'\n      },\n      btnLeft: {\n        flexGrow: 1,\n        display: 'flex',\n        justifyContent: 'flex-start'\n      },\n      btnRight: {\n        flexGrow: 1,\n        display: 'flex',\n        justifyContent: 'flex-end'\n      }\n    });\n  })();\n\n  var _useState = useState({\n    open: false,\n    level: 'info',\n    message: ''\n  }),\n      alertOptions = _useState[0],\n      setAlertOptions = _useState[1];\n\n  var _useState2 = useState(false),\n      sending = _useState2[0],\n      setSending = _useState2[1];\n\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser;\n\n  var client = useApolloClient();\n\n  var _client$readQuery = client.readQuery({\n    query: GET_APPLICATION_PROFILE_QUERY\n  }),\n      applicationProfile = _client$readQuery.applicationProfile;\n\n  var _client$readQuery2 = client.readQuery({\n    query: GET_APPLIER_QUERY\n  }),\n      applier = _client$readQuery2.applier;\n\n  var steps = getSteps(!!currentUser);\n\n  var _useState3 = useState('ConfirmAccount'),\n      step = _useState3[0],\n      setStep = _useState3[1];\n\n  var activeStep = step === 'ApplicationConfirmation' ? currentUser ? 3 : 4 : steps.filter(function (s) {\n    return s.step === step;\n  })[0].id;\n\n  var idBody = function idBody(data) {\n    return \"\\n      <div>\\n        <p>Dear \".concat(data.name, \", your application is being processed; you will have a response as soon as possible. See details below:</p>\\n\\n        <h3>Name and Email</h3>\\n        <p><strong>Name</strong><br/>\").concat(data.name, \"</p>\\n        <p><strong>Email</strong><br/>\").concat(data.email, \"</p>\\n        <br />\\n        <br />\\n      </div>\\n    \");\n  };\n\n  var sessionBody = function sessionBody() {\n    return \"\\n      <div>\\n        <h3>Session details</h3>\\n        <p><strong>Department</strong><br/>\".concat(props.departmentTitle, \"</p>\\n        <p><strong>Program</strong><br/>\").concat(props.programTitle, \"</p>\\n        <p><strong>Plan</strong><br/>\").concat(props.planTitle, \"</p>\\n        <p><strong>Training</strong><br/>\").concat(props.trainingTitle, \"</p>\\n        <p><strong>Session</strong><br/>\").concat(props.session.title, \"</p>\\n        <p><strong>Start date</strong><br/>\").concat(new Date(props.session.startDate).toLocaleDateString(), \"</p>\\n        <p><strong>Duration</strong><br/>\").concat(props.planDuration, \"</p>\\n        <br />\\n        <br />\\n      </div>\\n    \");\n  };\n\n  var profileBody = function profileBody(profile) {\n    return \"\\n      <div>\\n        <h3>Profile details</h3>\\n        <p><strong>Birthdate</strong><br/>\".concat(new Date(profile.birthDate).toLocaleDateString(), \"</p>\\n        <p><strong>Birth place</strong><br/>\").concat(profile.birthPlace, \"</p>\\n        <p><strong>Residence</strong><br/>\").concat(profile.residence, \"</p>\\n        <p><strong>Phone number</strong><br/>\").concat(profile.phoneNumber, \"</p>\\n        <p><strong>Nationality</strong><br/>\").concat(profile.nationality, \"</p>\\n        <p><strong>ID Card number</strong><br/>\").concat(profile.nicNumber || '(missing)', \"</p>\\n        <p><strong>Date of issue</strong><br/>\").concat(profile.nicDateOfIssue ? new Date(profile.birthDate).toLocaleDateString() : '(missing)', \"</p>\\n        <p><strong>Place of issue</strong><br/>\").concat(profile.nicPlaceOfIssue || '(missing)', \"</p>\\n        <p><strong>Highest academic qualification</strong><br/>\").concat(profile.highestAcademicQualification || '(missing)', \"</p>\\n        <p><strong>Year of issue</strong><br/>\").concat(profile.yearOfIssue || '(missing)', \"</p>\\n        <p><strong>English grade in GCEOL</strong><br/>\").concat(profile.englishGradeInGCEOL || '(missing)', \"</p>\\n        <p><strong>Mathematic grade in GCEOL</strong><br/>\").concat(profile.mathematicsGradeInGCEOL || '(missing)', \"</p>\\n        <p><strong>Professional qualification</strong><br/>\").concat(profile.professionalQualification || '(missing)', \"</p>\\n        <p><strong>Employment status</strong><br/>\").concat(profile.employmentStatus || '(missing)', \"</p>\\n        <p><strong>Job title</strong><br/>\").concat(profile.jobTitle || '(missing)', \"</p>\\n        <p><strong>Years of experience</strong><br/>\").concat(profile.yearsOfExperience || '(missing)', \"</p>\\n        <p><strong>Employer name</strong><br/>\").concat(profile.employerName || '(missing)', \"</p>\\n        <p><strong>Employer address</strong><br/>\").concat(profile.employerAddress || '(missing)', \"</p>\\n        <p><strong>Other details</strong><br/>\").concat(profile.otherDetails || '(missing)', \"</p>\\n        <br />\\n        <br />\\n      </div>\\n    \");\n  };\n\n  var goToStep = function goToStep(nextStep) {\n    return setStep(nextStep);\n  };\n\n  var handleBack = function handleBack() {\n    switch (step) {\n      case 'ConfirmAccount':\n        return;\n\n      case 'FillApplicationForm':\n        return goToStep('ConfirmAccount');\n\n      case 'ReviewProfileData':\n        if (currentUser) return goToStep('ConfirmAccount');else return goToStep('FillApplicationForm');\n\n      case 'ReviewTrainingSession':\n        return goToStep('ReviewProfileData');\n    }\n  };\n\n  function getSteps(loggedIn) {\n    var steps = [];\n    var index = 0;\n    steps.push({\n      step: 'ConfirmAccount',\n      caption: 'Confirm your account',\n      id: index\n    });\n    index += 1;\n\n    if (!loggedIn) {\n      steps.push({\n        step: 'FillApplicationForm',\n        caption: 'Fill application form',\n        id: index\n      });\n      index += 1;\n    }\n\n    steps.push({\n      step: 'ReviewProfileData',\n      caption: 'Review your profile',\n      id: index\n    });\n    index += 1;\n    steps.push({\n      step: 'ReviewTrainingSession',\n      caption: 'Review training session',\n      id: index\n    });\n    return steps;\n  }\n\n  function ConfirmAccountStep() {\n    var classes = makeStyles(function (theme) {\n      return createStyles({\n        root: {\n          marginBottom: 40,\n          paddingTop: 30,\n          paddingBottom: 15,\n          textAlign: 'center'\n        },\n        hasAccount: {},\n        noAccount: {\n          marginBottom: 30\n        }\n      });\n    })();\n    return __jsx(Container, {\n      maxWidth: 500\n    }, __jsx(\"div\", {\n      style: {\n        padding: 10,\n        textAlign: 'center'\n      }\n    }, __jsx(Typography, {\n      variant: \"h5\"\n    }, \"Confirm your account\")), __jsx(\"div\", {\n      className: classes.root\n    }, currentUser ? __jsx(\"div\", null, __jsx(\"div\", {\n      style: {\n        fontWeight: 'bold'\n      }\n    }, \"You are applying as\"), __jsx(\"div\", null, __jsx(Typography, {\n      variant: \"h4\",\n      color: \"secondary\"\n    }, currentUser.fullName)), __jsx(\"div\", {\n      style: {\n        fontSize: '10pt',\n        color: '#808080',\n        marginBottom: 10\n      }\n    }, \"(\", currentUser.email, \")\"), __jsx(\"div\", null, __jsx(Button, {\n      size: \"large\",\n      variant: \"contained\",\n      color: \"secondary\",\n      onClick: function onClick() {\n        return goToStep('ReviewProfileData');\n      }\n    }, \"Review your profile\")), __jsx(Container, {\n      maxWidth: 300\n    }, __jsx(\"div\", {\n      style: {\n        fontSize: '9pt',\n        color: '#808080',\n        textAlign: 'center',\n        paddingTop: 10\n      }\n    }, \"If you want to use a different account, sign out first, then sign in with the right account.\"))) : __jsx(\"div\", null, __jsx(\"div\", {\n      className: classes.noAccount\n    }, __jsx(\"div\", {\n      style: {\n        fontWeight: 'bold',\n        marginBottom: 15\n      }\n    }, \"Don't have an account yet ?\"), __jsx(\"div\", null, __jsx(ApplierForm, {\n      data: applier,\n      onSubmit: function onSubmit(data) {\n        client.writeQuery({\n          query: GET_APPLIER_QUERY,\n          data: {\n            applier: _objectSpread({\n              __typename: 'Applier'\n            }, data)\n          }\n        });\n        goToStep('FillApplicationForm');\n      }\n    })), __jsx(Container, {\n      maxWidth: 300\n    }, __jsx(\"div\", {\n      style: {\n        fontSize: '9pt',\n        color: '#808080',\n        textAlign: 'center',\n        paddingTop: 10\n      }\n    }, \"If your application is successfull, those information will be used to create your account.\"))), __jsx(\"div\", {\n      className: classes.hasAccount\n    }, \"Already have an account ? \\xA0\", __jsx(Link, {\n      href: {\n        pathname: '/signIn',\n        query: {\n          backTo: \"/application?tsId=\".concat(props.session.id)\n        }\n      }\n    }, __jsx(\"a\", {\n      style: {\n        textDecoration: 'none',\n        color: 'green'\n      }\n    }, \"Sign in\"))))));\n  }\n\n  function FillApplicationFormStep(props) {\n    return __jsx(\"div\", null, __jsx(\"div\", {\n      style: {\n        textAlign: 'center'\n      }\n    }, __jsx(\"div\", {\n      style: {\n        padding: 10,\n        textAlign: 'center'\n      }\n    }, __jsx(Typography, {\n      variant: \"h5\"\n    }, \"Application form\")), __jsx(Container, {\n      maxWidth: 600\n    }, __jsx(ProfileForm, {\n      profile: applicationProfile,\n      submitText: \"Save and Review your data\",\n      onSubmit: function onSubmit(data) {\n        return props.onSubmit(data);\n      }\n    })), __jsx(\"br\", null)));\n  }\n\n  function ReviewProfileDataStep() {\n    if (currentUser && !props.profile) return __jsx(\"div\", {\n      style: {\n        textAlign: 'center',\n        padding: 50\n      }\n    }, \"You don't have a profile yet. Please \", __jsx(Link, {\n      href: \"/myProfile\"\n    }, __jsx(\"a\", null, \"create your profile\")), \" and retry to apply.\");\n    return __jsx(\"div\", {\n      style: {\n        textAlign: 'center'\n      }\n    }, __jsx(\"div\", {\n      style: {\n        padding: 10,\n        textAlign: 'center'\n      }\n    }, __jsx(Typography, {\n      variant: \"h5\"\n    }, \"Review your Profile\")), currentUser ? __jsx(\"div\", null, __jsx(\"div\", {\n      style: {\n        fontSize: '9pt',\n        color: '#808080',\n        margin: '10px 0px'\n      }\n    }, \"If your profile is not up to date, please update it first then try to apply again.\"), __jsx(ProfileView, {\n      profile: currentUser.profile\n    })) : __jsx(\"div\", null, __jsx(ProfileView, {\n      profile: applicationProfile\n    })), __jsx(\"br\", null), __jsx(\"div\", null, (currentUser && currentUser.profile || !currentUser) && __jsx(Button, {\n      size: \"large\",\n      variant: \"contained\",\n      color: \"secondary\",\n      onClick: function onClick() {\n        return goToStep('ReviewTrainingSession');\n      }\n    }, \"Review Training Session Details\")), __jsx(\"br\", null));\n  }\n\n  function ReviewTrainingSessionStep() {\n    var classes = makeStyles(function (theme) {\n      return createStyles({\n        root: {\n          marginBottom: 40,\n          textAlign: 'center'\n        }\n      });\n    })();\n    if (currentUser && !props.profile) return __jsx(\"div\", {\n      style: {\n        textAlign: 'center',\n        padding: 50\n      }\n    }, \"You don't have a profile yet. Please \", __jsx(Link, {\n      href: \"/myProfile\"\n    }, __jsx(\"a\", null, \"create your profile\")), \" and retry to apply.\");\n    return __jsx(Container, {\n      maxWidth: 600\n    }, __jsx(\"div\", {\n      style: {\n        padding: 10,\n        textAlign: 'center'\n      }\n    }, __jsx(Typography, {\n      variant: \"h5\"\n    }, \"Review Training Session Details\")), __jsx(\"div\", {\n      className: classes.root\n    }, __jsx(\"div\", null, __jsx(\"div\", null, __jsx(Paper, {\n      style: {\n        padding: 10\n      }\n    }, __jsx(Table, {\n      size: \"small\",\n      style: {\n        border: '1px solid #DFDFDF'\n      }\n    }, __jsx(TableBody, null, __jsx(TableRow, {\n      key: \"dep\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Department\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.departmentTitle)), __jsx(TableRow, {\n      key: \"program\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Program\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.programTitle)), __jsx(TableRow, {\n      key: \"plan\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Plan\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.planTitle)), __jsx(TableRow, {\n      key: \"training\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Training\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.trainingTitle)), __jsx(TableRow, {\n      key: \"session\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Session\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.session.title)), __jsx(TableRow, {\n      key: \"sdate\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Start date\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.session.startDate)), __jsx(TableRow, {\n      key: \"duration\"\n    }, __jsx(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      style: {\n        color: '#808080'\n      }\n    }, \"Duration\"), __jsx(TableCell, {\n      align: \"right\"\n    }, props.planDuration))))), props.session.fees.length > 0 ? __jsx(Paper, {\n      style: {\n        marginTop: 10,\n        padding: 10\n      }\n    }, __jsx(\"div\", {\n      style: {\n        fontWeight: 'bold',\n        padding: '5px 0px',\n        borderBottom: '1px solid #DFDFDF',\n        marginBottom: 5,\n        color: '#808080'\n      }\n    }, \"Fees\"), __jsx(Table, {\n      size: \"small\",\n      style: {\n        border: '1px solid #DFDFDF'\n      }\n    }, __jsx(TableHead, null, __jsx(TableRow, {\n      style: {\n        backgroundColor: '#DFDFDF'\n      }\n    }, __jsx(TableCell, null, \"Description\"), __jsx(TableCell, null, \"Type\"), __jsx(TableCell, {\n      align: \"right\"\n    }, \"Amount\"))), __jsx(TableBody, null, props.session.fees.map(function (f) {\n      return __jsx(TableRow, {\n        key: f.id\n      }, __jsx(TableCell, null, f.description, \" \", f.optional && __jsx(\"span\", {\n        style: {\n          color: '#808080'\n        }\n      }, \"(Optional)\")), __jsx(TableCell, null, f.feeType), __jsx(TableCell, {\n        align: \"right\"\n      }, f.promotionalAmount > 0 ? __jsx(\"div\", null, __jsx(\"span\", {\n        style: {\n          textDecoration: 'line-through'\n        }\n      }, f.amount), \" \\xA0\", __jsx(\"span\", {\n        style: {\n          color: 'orange'\n        }\n      }, f.promotionalAmount)) : __jsx(\"span\", null, f.amount)));\n    }))), __jsx(Container, {\n      maxWidth: 400\n    }, __jsx(\"div\", {\n      style: {\n        fontSize: '9pt',\n        color: '#808080',\n        textAlign: 'center',\n        paddingTop: 10\n      }\n    }, __jsx(\"strong\", null, \"Note: \"), \" These fees are the training fees at the time the session was created, they might be different from the current training fees.\"))) : __jsx(\"div\", {\n      style: {\n        padding: 20\n      }\n    }, \"No fees\")), __jsx(\"div\", null, __jsx(Button, {\n      size: \"large\",\n      variant: \"contained\",\n      color: \"secondary\",\n      style: {\n        marginTop: 15\n      },\n      disabled: sending,\n      onClick: function _callee() {\n        var messageBody, errorMessage;\n        return _regeneratorRuntime.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                messageBody = currentUser ? idBody({\n                  name: currentUser.fullName,\n                  email: currentUser.email\n                }) : idBody(applier);\n                messageBody += sessionBody();\n                if (currentUser) messageBody += '<p><h3>Profile details</h3> (Existing user)</p>';else messageBody += profileBody(applicationProfile);\n                _context.prev = 3;\n                setSending(true);\n                _context.next = 7;\n                return _regeneratorRuntime.awrap(sendMail({\n                  subject: \"Application form (\".concat(currentUser ? currentUser.fullName : applier.name, \")\"),\n                  body: messageBody,\n                  to: applicationReceiver\n                }));\n\n              case 7:\n                goToStep('ApplicationConfirmation');\n                resetApplicationData(client);\n                _context.next = 16;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](3);\n                errorMessage = _context.t0.message;\n                if (_context.t0.response) errorMessage = _JSON$stringify(_context.t0.response.data.err);\n                setAlertOptions({\n                  open: true,\n                  level: 'error',\n                  message: \"Could not send email: \".concat(errorMessage)\n                });\n\n              case 16:\n                _context.prev = 16;\n                setSending(false);\n                _context.prev = 18;\n                _context.next = 21;\n                return _regeneratorRuntime.awrap(sendMail({\n                  subject: \"Application form received (\".concat(currentUser ? currentUser.fullName : applier.name, \")\"),\n                  body: messageBody,\n                  to: applier.email\n                }));\n\n              case 21:\n                _context.next = 25;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t1 = _context[\"catch\"](18);\n\n              case 25:\n                return _context.finish(16);\n\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, [[3, 11, 16, 26], [18, 23]]);\n      }\n    }, sending ? __jsx(CircularProgress, null) : 'Apply')))));\n  }\n\n  function ApplicationConfirmationStep() {\n    return __jsx(\"div\", {\n      style: {\n        textAlign: 'center',\n        margin: '50px 0px',\n        fontSize: '10pt',\n        color: '#808080'\n      }\n    }, __jsx(\"img\", {\n      src: \"/images/success.png\",\n      width: \"100\",\n      height: \"100\"\n    }), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"div\", null, \"Your application has been received and is being processed. We will contact you shortly.\"));\n  }\n\n  return __jsx(\"div\", {\n    className: classes.root\n  }, __jsx(Paper, {\n    style: {\n      padding: 5\n    }\n  }, __jsx(Hidden, {\n    smDown: true\n  }, __jsx(Stepper, {\n    activeStep: activeStep,\n    alternativeLabel: true\n  }, steps.map(function (s) {\n    return __jsx(Step, {\n      key: s.id\n    }, __jsx(StepLabel, null, s.caption));\n  }))), __jsx(Hidden, {\n    mdUp: true\n  }, __jsx(\"div\", {\n    style: {\n      textAlign: 'center'\n    }\n  }, step !== 'ApplicationConfirmation' ? __jsx(\"span\", null, \"Step \", activeStep + 1, \" / \", steps.length) : __jsx(\"span\", null, \"Done\")))), __jsx(\"div\", {\n    style: {\n      minHeight: 250\n    }\n  }, step === 'ConfirmAccount' && __jsx(ConfirmAccountStep, null), step === 'FillApplicationForm' && __jsx(FillApplicationFormStep, {\n    onSubmit: function onSubmit(data) {\n      goToStep('ReviewProfileData');\n      client.writeQuery({\n        query: GET_APPLICATION_PROFILE_QUERY,\n        data: {\n          applicationProfile: _objectSpread({\n            __typename: 'ProfileData'\n          }, data)\n        }\n      });\n    }\n  }), step === 'ReviewProfileData' && __jsx(ReviewProfileDataStep, null), step === 'ReviewTrainingSession' && __jsx(ReviewTrainingSessionStep, null), step === 'ApplicationConfirmation' && __jsx(ApplicationConfirmationStep, null)), __jsx(\"div\", null, step !== 'ApplicationConfirmation' && __jsx(\"div\", {\n    className: classes.btnBar\n  }, __jsx(\"div\", {\n    className: classes.btnLeft\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"default\",\n    disabled: activeStep === 0,\n    onClick: handleBack\n  }, \"Back\")), __jsx(\"div\", {\n    className: classes.btnRight\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"default\",\n    onClick: function onClick() {\n      resetApplicationData(client);\n      props.handleCancel();\n    }\n  }, \"Cancel\")))), __jsx(Alert, {\n    level: alertOptions.level,\n    message: alertOptions.message,\n    open: alertOptions.open,\n    onClose: function onClose() {\n      return setAlertOptions({\n        open: false,\n        level: alertOptions.level,\n        message: alertOptions.message\n      });\n    }\n  }));\n}","map":{"version":3,"sources":["/data/apps/school-manager-client/components/ApplicationStepper.tsx"],"names":["React","useState","makeStyles","createStyles","Stepper","Step","StepLabel","Button","Paper","Hidden","Typography","Table","TableHead","TableBody","TableRow","TableCell","CircularProgress","Container","useAuth","ProfileForm","ProfileView","Link","gql","useApolloClient","ApplierForm","Alert","sendMail","applicationReceiver","GET_APPLICATION_PROFILE_QUERY","GET_APPLIER_QUERY","resetApplicationData","client","writeQuery","query","data","applier","__typename","name","email","applicationProfile","birthDate","birthPlace","residence","phoneNumber","nationality","nicNumber","nicDateOfIssue","nicPlaceOfIssue","highestAcademicQualification","yearOfIssue","Date","getFullYear","englishGradeInGCEOL","mathematicsGradeInGCEOL","professionalQualification","employmentStatus","jobTitle","yearsOfExperience","employerName","employerAddress","otherDetails","ApplicationStepper","props","classes","theme","root","width","btnBar","display","padding","borderTop","btnLeft","flexGrow","justifyContent","btnRight","open","level","message","alertOptions","setAlertOptions","sending","setSending","currentUser","readQuery","steps","getSteps","step","setStep","activeStep","filter","s","id","idBody","sessionBody","departmentTitle","programTitle","planTitle","trainingTitle","session","title","startDate","toLocaleDateString","planDuration","profileBody","profile","goToStep","nextStep","handleBack","loggedIn","index","push","caption","ConfirmAccountStep","marginBottom","paddingTop","paddingBottom","textAlign","hasAccount","noAccount","fontWeight","fullName","fontSize","color","pathname","backTo","textDecoration","FillApplicationFormStep","onSubmit","ReviewProfileDataStep","margin","ReviewTrainingSessionStep","border","fees","length","marginTop","borderBottom","backgroundColor","map","f","description","optional","feeType","promotionalAmount","amount","messageBody","subject","body","to","errorMessage","response","err","ApplicationConfirmationStep","minHeight","handleCancel"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles'\nimport { \n  Stepper, \n  Step, \n  StepLabel, \n  Button, \n  Paper, \n  Hidden, \n  Typography,\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n  CircularProgress\n} from '@material-ui/core'\nimport ITrainingSession from '../server/src/models/catalog/TrainingSession'\nimport IAccountProfileFields from '../server/src/models/accounts/AccountProfile'\nimport Container from './Container'\nimport { useAuth } from '../components/AuthContext'\nimport ProfileForm from '../components/ProfileForm'\nimport ProfileView from './ProfileView'\nimport Link from 'next/link'\nimport { IProfileData } from '../server/src/models/accounts/AccountProfile'\nimport { gql, ApolloClient } from 'apollo-boost'\nimport { useApolloClient } from '@apollo/react-hooks'\nimport ApplierForm from './ApplierForm'\nimport Alert, { AlertOptions } from '../components/Alert'\nimport sendMail from '../lib/send-mail'\nimport { applicationReceiver } from '../app.config'\n\nexport type StepItem = 'ConfirmAccount' \n  | 'FillApplicationForm' \n  | 'ReviewProfileData' \n  | 'ReviewTrainingSession' \n  | 'ApplicationConfirmation'\n\n\nconst GET_APPLICATION_PROFILE_QUERY = gql`\n  query getApplicationProfile {\n    applicationProfile @client {\n      birthDate\n      birthPlace\n      residence\n      phoneNumber\n      nationality\n      nicNumber\n      nicDateOfIssue\n      nicPlaceOfIssue\n      highestAcademicQualification\n      yearOfIssue\n      englishGradeInGCEOL\n      mathematicsGradeInGCEOL\n      professionalQualification\n      employmentStatus\n      jobTitle\n      yearsOfExperience\n      employerName\n      employerAddress\n      otherDetails\n    }\n  }\n`\n\nconst GET_APPLIER_QUERY = gql`\n  query getApplier {\n    applier @client {\n      name\n      email\n    }\n  }\n`\n\nconst resetApplicationData = (client: any) => {\n  client.writeQuery({\n    query: GET_APPLIER_QUERY,\n    data: { applier: { __typename: 'Applier', name: '', email: '' } }\n  })\n\n  client.writeQuery({\n    query: GET_APPLICATION_PROFILE_QUERY,\n    data: {\n      applicationProfile: {\n        __typename: 'ProfileData',\n        birthDate: null,\n        birthPlace: '',\n        residence: '',\n        phoneNumber: '',\n        nationality: '',\n        nicNumber: '',\n        nicDateOfIssue: null,\n        nicPlaceOfIssue: '',\n        highestAcademicQualification: '',\n        yearOfIssue: new Date().getFullYear(),\n        englishGradeInGCEOL: '',\n        mathematicsGradeInGCEOL: '',\n        professionalQualification: '',\n        employmentStatus: 'JobSeeker',\n        jobTitle: '',\n        yearsOfExperience: 0,\n        employerName: '',\n        employerAddress: '',\n        otherDetails: null\n      }\n    }\n  })\n}\n\nexport default function ApplicationStepper(\n  props: { \n    handleCancel: Function,\n    trainingTitle: string,\n    departmentTitle: string,\n    programTitle: string,\n    planTitle: string,\n    planDuration: string,\n    session: ITrainingSession,\n    profile: IAccountProfileFields\n  }\n) {\n  const classes = makeStyles((theme: Theme) => createStyles({\n    root: { width: '100%' },\n    btnBar: {\n      display: 'flex',\n      padding: '10px 0px',\n      borderTop: '1px solid #DFDFDF'\n    },\n    btnLeft: {\n      flexGrow: 1,\n      display: 'flex',\n      justifyContent: 'flex-start'\n    },\n    btnRight: {\n      flexGrow: 1,\n      display: 'flex',\n      justifyContent: 'flex-end'\n    }\n  }))()\n\n  const [alertOptions, setAlertOptions] = useState<AlertOptions>({ open: false, level: 'info', message: '' })\n  const [sending, setSending] = useState<boolean>(false)\n  const { currentUser } = useAuth()\n  const client = useApolloClient()\n  const { applicationProfile }: any = client.readQuery({ query: GET_APPLICATION_PROFILE_QUERY })\n  const { applier }: any = client.readQuery({ query: GET_APPLIER_QUERY })\n  const steps = getSteps(!!currentUser)\n  const [step, setStep] = useState<StepItem>('ConfirmAccount')\n  const activeStep = step === 'ApplicationConfirmation' ? \n    (currentUser ? 3 : 4) : \n    steps.filter(s => s.step === step)[0].id\n\n\n  const idBody = (data: { name: string, email: string }) => {\n    return `\n      <div>\n        <p>Dear ${data.name}, your application is being processed; you will have a response as soon as possible. See details below:</p>\n\n        <h3>Name and Email</h3>\n        <p><strong>Name</strong><br/>${data.name}</p>\n        <p><strong>Email</strong><br/>${data.email}</p>\n        <br />\n        <br />\n      </div>\n    `\n  }\n\n  const sessionBody = () => {\n    return `\n      <div>\n        <h3>Session details</h3>\n        <p><strong>Department</strong><br/>${props.departmentTitle}</p>\n        <p><strong>Program</strong><br/>${props.programTitle}</p>\n        <p><strong>Plan</strong><br/>${props.planTitle}</p>\n        <p><strong>Training</strong><br/>${props.trainingTitle}</p>\n        <p><strong>Session</strong><br/>${props.session.title}</p>\n        <p><strong>Start date</strong><br/>${new Date(props.session.startDate).toLocaleDateString()}</p>\n        <p><strong>Duration</strong><br/>${props.planDuration}</p>\n        <br />\n        <br />\n      </div>\n    `\n  }\n\n  const profileBody = (profile: IProfileData) => {\n    return `\n      <div>\n        <h3>Profile details</h3>\n        <p><strong>Birthdate</strong><br/>${new Date(profile.birthDate).toLocaleDateString()}</p>\n        <p><strong>Birth place</strong><br/>${profile.birthPlace}</p>\n        <p><strong>Residence</strong><br/>${profile.residence}</p>\n        <p><strong>Phone number</strong><br/>${profile.phoneNumber}</p>\n        <p><strong>Nationality</strong><br/>${profile.nationality}</p>\n        <p><strong>ID Card number</strong><br/>${profile.nicNumber || '(missing)'}</p>\n        <p><strong>Date of issue</strong><br/>${profile.nicDateOfIssue ? new Date(profile.birthDate).toLocaleDateString() : '(missing)'}</p>\n        <p><strong>Place of issue</strong><br/>${profile.nicPlaceOfIssue || '(missing)'}</p>\n        <p><strong>Highest academic qualification</strong><br/>${profile.highestAcademicQualification || '(missing)'}</p>\n        <p><strong>Year of issue</strong><br/>${profile.yearOfIssue || '(missing)'}</p>\n        <p><strong>English grade in GCEOL</strong><br/>${profile.englishGradeInGCEOL || '(missing)'}</p>\n        <p><strong>Mathematic grade in GCEOL</strong><br/>${profile.mathematicsGradeInGCEOL || '(missing)'}</p>\n        <p><strong>Professional qualification</strong><br/>${profile.professionalQualification || '(missing)'}</p>\n        <p><strong>Employment status</strong><br/>${profile.employmentStatus || '(missing)'}</p>\n        <p><strong>Job title</strong><br/>${profile.jobTitle || '(missing)'}</p>\n        <p><strong>Years of experience</strong><br/>${profile.yearsOfExperience || '(missing)'}</p>\n        <p><strong>Employer name</strong><br/>${profile.employerName || '(missing)'}</p>\n        <p><strong>Employer address</strong><br/>${profile.employerAddress || '(missing)'}</p>\n        <p><strong>Other details</strong><br/>${profile.otherDetails || '(missing)'}</p>\n        <br />\n        <br />\n      </div>\n    `\n  }\n\n  const goToStep = (nextStep: StepItem) => setStep(nextStep)\n  \n  const handleBack = () => {\n    switch (step) {\n      case 'ConfirmAccount':\n        return\n      case 'FillApplicationForm':\n        return goToStep('ConfirmAccount')\n\n      case 'ReviewProfileData':\n        if (currentUser) return goToStep('ConfirmAccount')\n        else return goToStep('FillApplicationForm')\n\n      case 'ReviewTrainingSession':\n        return goToStep('ReviewProfileData')\n    }\n  }\n  \n  function getSteps(loggedIn: boolean) {\n    const steps = []; let index = 0\n\n    steps.push({ step: 'ConfirmAccount', caption: 'Confirm your account', id: index }); index += 1\n    if (!loggedIn) {steps.push({ step: 'FillApplicationForm', caption: 'Fill application form', id: index }); index += 1 }\n    steps.push({ step: 'ReviewProfileData', caption: 'Review your profile', id: index });  index += 1\n    steps.push({ step: 'ReviewTrainingSession', caption: 'Review training session', id: index })\n\n    return steps\n  }\n\n  function ConfirmAccountStep() {\n    const classes = makeStyles((theme: Theme) => createStyles({\n      root: {\n        marginBottom: 40,\n        paddingTop: 30,\n        paddingBottom: 15,\n        textAlign: 'center'\n      },\n      hasAccount: {},\n      noAccount: {\n        marginBottom: 30\n      }\n    }))()\n  \n    return (\n      <Container maxWidth={500}>\n        <div style={{padding: 10, textAlign: 'center'}}>\n          <Typography variant=\"h5\">Confirm your account</Typography>\n        </div>\n  \n        <div className={classes.root}>\n          {currentUser ?\n            <div>\n              <div style={{ fontWeight: 'bold' }}>You are applying as</div>\n              <div><Typography variant=\"h4\" color=\"secondary\">{currentUser.fullName}</Typography></div>\n              <div style={{ fontSize: '10pt', color: '#808080', marginBottom: 10 }}>({currentUser.email})</div>\n              <div>\n                <Button \n                  size=\"large\" \n                  variant=\"contained\" \n                  color=\"secondary\"\n                  onClick={() => goToStep('ReviewProfileData')}\n                >\n                  Review your profile\n                </Button>\n              </div>\n  \n              <Container maxWidth={300}>\n                <div style={{ fontSize: '9pt', color: '#808080', textAlign: 'center', paddingTop: 10 }}>\n                  If you want to use a different account, sign out first, then sign in with the right account.\n                </div>\n              </Container>\n            </div> :\n  \n            <div>\n              <div className={classes.noAccount}>\n                <div style={{ fontWeight: 'bold', marginBottom: 15 }}>Don't have an account yet ?</div>\n                <div>\n                  <ApplierForm\n                    data={applier}\n                    onSubmit={(data: any) => {\n                      client.writeQuery({\n                        query: GET_APPLIER_QUERY,\n                        data: {\n                          applier: {\n                            __typename: 'Applier',\n                            ...data\n                          }\n                        }\n                      })\n\n                      goToStep('FillApplicationForm')\n                    }}\n                  />\n                </div>\n  \n                <Container maxWidth={300}>\n                  <div style={{ fontSize: '9pt', color: '#808080', textAlign: 'center', paddingTop: 10 }}>\n                    If your application is successfull, those information will be used to create your account.\n                  </div>\n                </Container>\n              </div>\n  \n              <div className={classes.hasAccount}>\n                Already have an account ? &nbsp;\n                <Link \n                  href={{ \n                    pathname: '/signIn', \n                    query: { backTo: `/application?tsId=${props.session.id}` }\n                  }}\n                >\n                  <a style={{ textDecoration: 'none', color: 'green' }}>Sign in</a>\n                </Link>\n              </div>\n            </div>\n          }\n        </div>\n      </Container>\n    )\n  }\n  \n  function FillApplicationFormStep(props: { onSubmit: (data: IProfileData) => void }) {\n    return (\n      <div>\n        <div style={{textAlign: 'center'}}>\n          <div style={{padding: 10, textAlign: 'center'}}>\n            <Typography variant=\"h5\">Application form</Typography>\n          </div>\n  \n          <Container maxWidth={600}>\n            <ProfileForm \n              profile={applicationProfile}\n              submitText=\"Save and Review your data\"\n              onSubmit={(data) => props.onSubmit(data)}\n            />\n          </Container>\n  \n          <br />\n        </div>\n      </div>\n    )\n  }\n  \n  function ReviewProfileDataStep() {\n    if (currentUser && !props.profile) \n      return (\n        <div style={{ textAlign: 'center', padding: 50 }}>\n          You don't have a profile yet. Please <Link href=\"/myProfile\"><a>create your profile</a></Link> and retry to apply.\n        </div>\n      )\n  \n    return (\n      <div style={{textAlign: 'center'}}>\n        <div style={{padding: 10, textAlign: 'center'}}>\n          <Typography variant=\"h5\">Review your Profile</Typography>\n        </div>\n  \n        {currentUser ?\n          <div>\n            <div style={{ fontSize: '9pt', color: '#808080', margin: '10px 0px' }}>\n              If your profile is not up to date, please update it first then try to apply again.\n            </div>\n  \n            <ProfileView profile={currentUser.profile} />\n          </div> :\n  \n          <div>\n            <ProfileView profile={applicationProfile} />\n          </div>\n        }\n  \n        <br />\n  \n        <div>\n          {((currentUser && currentUser.profile) || (!currentUser)) && \n            <Button \n              size=\"large\" \n              variant=\"contained\" \n              color=\"secondary\"\n              onClick={() => goToStep('ReviewTrainingSession')}\n            >\n              Review Training Session Details\n            </Button>\n          }\n        </div>\n  \n        <br />\n      </div>\n    )\n  }\n  \n  function ReviewTrainingSessionStep() {\n    const classes = makeStyles((theme: Theme) => createStyles({\n      root: {\n        marginBottom: 40,\n        textAlign: 'center'\n      }\n    }))()\n  \n    if (currentUser && !props.profile) \n      return (\n        <div style={{ textAlign: 'center', padding: 50 }}>\n          You don't have a profile yet. Please <Link href=\"/myProfile\"><a>create your profile</a></Link> and retry to apply.\n        </div>\n      )\n  \n    return (\n      <Container maxWidth={600}>\n        <div style={{padding: 10, textAlign: 'center'}}>\n          <Typography variant=\"h5\">Review Training Session Details</Typography>\n        </div>\n  \n        <div className={classes.root}>\n          <div>\n            <div>  \n              <Paper style={{ padding: 10 }}>\n                <Table size=\"small\" style={{ border: '1px solid #DFDFDF' }}>\n                  <TableBody>\n                    <TableRow key=\"dep\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Department</TableCell>\n                      <TableCell align=\"right\">{props.departmentTitle}</TableCell>\n                    </TableRow>\n  \n                    <TableRow key=\"program\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Program</TableCell>\n                      <TableCell align=\"right\">{props.programTitle}</TableCell>\n                    </TableRow>\n  \n                    <TableRow key=\"plan\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Plan</TableCell>\n                      <TableCell align=\"right\">{props.planTitle}</TableCell>\n                    </TableRow>\n\n                    <TableRow key=\"training\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Training</TableCell>\n                      <TableCell align=\"right\">{props.trainingTitle}</TableCell>\n                    </TableRow>\n  \n                    <TableRow key=\"session\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Session</TableCell>\n                      <TableCell align=\"right\">{props.session.title}</TableCell>\n                    </TableRow>\n  \n                    <TableRow key=\"sdate\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Start date</TableCell>\n                      <TableCell align=\"right\">{props.session.startDate}</TableCell>\n                    </TableRow>\n  \n                    <TableRow key=\"duration\">\n                      <TableCell component=\"th\" scope=\"row\" style={{ color: '#808080' }}>Duration</TableCell>\n                      <TableCell align=\"right\">{props.planDuration}</TableCell>\n                    </TableRow>\n                  </TableBody>\n                </Table>\n              </Paper>\n  \n              {props.session.fees.length > 0 ?\n                <Paper style={{ marginTop: 10, padding: 10 }}>\n                  <div style={{ fontWeight: 'bold', padding: '5px 0px', borderBottom: '1px solid #DFDFDF', marginBottom: 5, color: '#808080' }}>Fees</div>\n  \n                  <Table size=\"small\" style={{ border: '1px solid #DFDFDF' }}>\n                    <TableHead>\n                      <TableRow style={{ backgroundColor: '#DFDFDF' }}>\n                        <TableCell>Description</TableCell>\n                        <TableCell>Type</TableCell>\n                        <TableCell align=\"right\">Amount</TableCell>\n                      </TableRow>\n                    </TableHead>\n  \n                    <TableBody>\n                      {props.session.fees.map(f => (\n                        <TableRow key={f.id}>\n                          <TableCell>{f.description} {f.optional && <span style={{color: '#808080'}}>(Optional)</span>}</TableCell>\n                          <TableCell>{f.feeType}</TableCell>\n                          <TableCell align=\"right\">\n                            {f.promotionalAmount > 0 ?\n                              <div>\n                                <span style={{textDecoration: 'line-through'}}>{f.amount}</span> &nbsp;\n                                <span style={{color: 'orange'}}>{f.promotionalAmount}</span>\n                              </div> :\n                              <span>{f.amount}</span>\n                            }\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n  \n                  <Container maxWidth={400}>\n                    <div style={{ fontSize: '9pt', color: '#808080', textAlign: 'center', paddingTop: 10 }}>\n                      <strong>Note: </strong> These fees are the training fees at the time the session was created, they might\n                      be different from the current training fees.\n                    </div>\n                  </Container>\n                </Paper> :\n                <div style={{ padding: 20 }}>No fees</div>\n              }\n            </div>\n  \n            <div>\n              <Button \n                size=\"large\" \n                variant=\"contained\" \n                color=\"secondary\"\n                style={{ marginTop: 15 }}\n                disabled={sending}\n                onClick={async () => {\n                  let messageBody = currentUser ? idBody({ name: currentUser.fullName, email: currentUser.email }) : idBody(applier)\n                  messageBody += sessionBody()\n                  if (currentUser) messageBody += '<p><h3>Profile details</h3> (Existing user)</p>'\n                  else messageBody += profileBody(applicationProfile)\n\n                  try {\n                    setSending(true)\n                    await sendMail({ \n                      subject: `Application form (${currentUser ? currentUser.fullName : applier.name})`, \n                      body: messageBody, \n                      to: applicationReceiver\n                    })\n                    goToStep('ApplicationConfirmation')\n                    resetApplicationData(client)\n                  } catch (ex) {\n                    let errorMessage = ex.message\n                    if (ex.response) errorMessage = JSON.stringify(ex.response.data.err)\n                    \n                    setAlertOptions({ \n                      open: true, \n                      level: 'error', \n                      message: `Could not send email: ${errorMessage}` })\n                  } finally {\n                    setSending(false)\n                    try {\n                      // send an email to the applier. If an error occured, do nothing.\n                      await sendMail({ \n                        subject: `Application form received (${currentUser ? currentUser.fullName : applier.name})`, \n                        body: messageBody, \n                        to: applier.email\n                      })\n                    } catch(ex) {/* Do nothing */}\n                  }\n                }}\n              >\n                {sending ? <CircularProgress /> : 'Apply'}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Container>\n    )\n  }\n  \n  function ApplicationConfirmationStep() {\n    return (\n      <div style={{ textAlign: 'center', margin: '50px 0px', fontSize: '10pt', color: '#808080' }}>\n        <img src=\"/images/success.png\" width=\"100\" height=\"100\" />\n        <br /><br />\n        <div>\n          Your application has been received and is being processed. We will contact you shortly.\n        </div>\n      </div>\n    )\n  }\n  \n  return (\n    <div className={classes.root}>\n      <Paper style={{ padding: 5 }}>\n        <Hidden smDown>\n          <Stepper activeStep={activeStep} alternativeLabel>\n            {steps.map(s =>\n              <Step key={s.id}>\n                <StepLabel>{s.caption}</StepLabel>\n              </Step>\n            )}\n          </Stepper>\n        </Hidden>\n\n        <Hidden mdUp>\n          <div style={{ textAlign: 'center' }}>\n            {step !== 'ApplicationConfirmation' ?\n              <span>Step {activeStep + 1} / {steps.length}</span> :\n              <span>Done</span>\n            }\n          </div>\n        </Hidden>\n      </Paper>\n\n      <div style={{ minHeight: 250 }}>\n        {step === 'ConfirmAccount' && <ConfirmAccountStep />}\n\n        {step === 'FillApplicationForm' &&\n          <FillApplicationFormStep\n            onSubmit={(data: IProfileData) => {\n              goToStep('ReviewProfileData')\n\n              client.writeQuery({\n                query: GET_APPLICATION_PROFILE_QUERY,\n                data: {\n                  applicationProfile: {\n                    __typename: 'ProfileData',\n                    ...data\n                  }\n                }\n              })\n            }}\n          /> \n        }\n\n        {step === 'ReviewProfileData' && <ReviewProfileDataStep />}\n        {step === 'ReviewTrainingSession' && <ReviewTrainingSessionStep />}\n        {step === 'ApplicationConfirmation' &&  <ApplicationConfirmationStep />}\n      </div>\n\n      <div>\n        {step !== 'ApplicationConfirmation' &&\n          <div className={classes.btnBar}>\n            <div className={classes.btnLeft}>\n              <Button variant=\"contained\" color=\"default\" disabled={activeStep === 0} onClick={handleBack}>Back</Button>\n            </div>\n\n            <div className={classes.btnRight}>\n              <Button \n                variant=\"contained\" \n                color=\"default\" \n                onClick={() => { resetApplicationData(client); props.handleCancel()}}\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        }\n      </div>\n\n\n      <Alert \n        level={alertOptions.level}\n        message={alertOptions.message}\n        open={alertOptions.open}\n        onClose={() => setAlertOptions({ open: false, level: alertOptions.level, message: alertOptions.message })}\n      />\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}